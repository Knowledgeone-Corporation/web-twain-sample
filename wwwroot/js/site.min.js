function RenderDesktopSelection(){K1WebTwain.GetDevices().then(function(n){for(var i,r=InitialiseDropDown($("#sel-scanner")),t=0;t<n.length;t++)r.append($("<option />").val(n[t].id).text(n[t].name));$("#sel-scanner").unbind();$("#device-group").show();BindAcquire();i=function(n,t){InitialiseDropDown(n);for(var i in t)n.append($("<option />").val(t[i]).text(i))};i($("#sel-ocr-type"),K1WebTwain.Options.OcrType);i($("#sel-output"),K1WebTwain.Options.OutputFiletype)}).catch(function(n){console.error(n)})}function RenderSelection(){K1WebTwain.GetDevices().then(function(n){$("#device-group").show();BindAcquire();var t=function(n,t){InitialiseDropDown(n);for(var i in t)n.append($("<option />").val(t[i]).text(i))};t($("#sel-ocr-type"),K1WebTwain.Options.OcrType);t($("#sel-output"),K1WebTwain.Options.OutputFiletype);BindScannerSelection(n)}).catch(function(n){console.error(n)})}function BindAcquire(){$("#btn-acquire").unbind();$("#btn-acquire").click(function(){$("#errorMessageDiv").hide();var n={};n.deviceId=$("#sel-scanner").val();n.resolutionId=$("#sel-dpi").val();n.pixelTypeId=$("#sel-color").val();n.filetype=$("#sel-output").val();n.ocrType=$("#sel-ocr-type").val();n.filename=$("#sel-output-name").val();n.pageSizeId=$("#sel-page-size").val();n.documentSourceId=$("#sel-document-source").val();n.duplexId=$("#sel-duplex").val();K1WebTwain.Acquire(n).then(function(n){$(".filename").val(n.filename);$(".filesize").text(n.sizeDisplay);$(".filesize").show();$(".fileview").show();$("#uploadResponseOutput").text(JSON.stringify(n.uploadResponse,null,4));$("#uploadResponseDiv").show()}).catch(n=>{console.error(n);try{$("#errorMessageOutput").text(JSON.stringify(n.responseJSON,null,4))}catch(t){$("#errorMessageOutput").text(n.responseText)}$("#errorMessageDiv").show()})})}function BindScannerSelection(n){for(var i=InitialiseDropDown($("#sel-scanner")),t=0;t<n.length;t++)i.append($("<option />").val(n[t].id).text(n[t].name));$("#sel-scanner").unbind();$("#sel-scanner").change(function(){var t=function(n,t){var r,i;if(InitialiseDropDown(n),r=jQuery.isEmptyObject(t),r){n.parent().hide();return}for(i in t)n.append($("<option />").val(i).text(t[i]));n.parent().show()},i=$("#sel-scanner").val(),n;if(i&&(n=K1WebTwain.Device(i),n)){var r=n.pixelTypeIds,u=n.resolutionIds,f=n.pageSizeIds,e=n.documentSourceIds,o=n.duplexIds;t($("#sel-color"),r);t($("#sel-dpi"),u);t($("#sel-page-size"),f);t($("#sel-document-source"),e);t($("#sel-duplex"),o)}})}function InitialiseDropDown(n){return n.empty(),n.append($("<option disabled selected>Please select<\/option>")),n.selectedIndex=-1,n}function K1ScanServiceComplete(n){console.log(n);$(".filename").val(n.filename);$(".filesize").text(n.sizeDisplay);$(".filesize").show();$(".fileview").show();$("#saveBtn").removeAttr("disabled");$("#uploadResponseOutput").text(JSON.stringify(n.uploadResponse,null,4));$("#uploadResponseDiv").show()}$(document).ready(function(){$("#interface-option-dropdown").change(function(n){$("#errorMessageDiv").hide();$(".twain-feature-group").hide();var t=$(n.target),i=parseInt(t.val()),r={onComplete:K1ScanServiceComplete,viewButton:$(".k1ViewBtn"),fileUploadURL:document.location.origin+"/Home/UploadFile",clientID:$("#ClientID").val(),setupFile:document.location.origin+"/Home/DownloadSetup",interfacePath:"",scannerInterface:i,scanButton:$("#scanbtn")};K1WebTwain.Configure(r).then(function(n){switch(n.scannerInterface){case K1WebTwain.Options.ScannerInterface.Visible:case K1WebTwain.Options.ScannerInterface.Web:$("#k1interface-visible").removeClass("hide");$("#k1interface-hidden").addClass("hide");break;case K1WebTwain.Options.ScannerInterface.Hidden:RenderSelection();$("#k1interface-visible").addClass("hide");$("#k1interface-hidden").removeClass("hide");break;case K1WebTwain.Options.ScannerInterface.Desktop:RenderDesktopSelection();$("#k1interface-visible").addClass("hide");$("#k1interface-hidden").removeClass("hide")}}).catch(function(n){$("#k1interface-visible").addClass("hide");$("#k1interface-hidden").addClass("hide");console.error(n);$("#errorMessageOutput").text(n);$("#errorMessageDiv").show()})});var n=$("#SelectedInterface").val();n.length>0&&$("#interface-option-dropdown").val(n).change()});